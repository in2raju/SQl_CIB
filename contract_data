DROP TABLE MRACIB.CIB_CONTRACT_DATA CASCADE CONSTRAINTS;

CREATE TABLE MRACIB.CIB_CONTRACT_DATA
(
  MFICODE                     VARCHAR2(10 BYTE),
  ACCOUNTINGDATE              VARCHAR2(50 BYTE),
  PRODUCTIONDATE              VARCHAR2(50 BYTE),
  RECORD_NO                   NUMBER,
  BRANCH_CODE                 VARCHAR2(50 BYTE),
  MEMBERID                    VARCHAR2(50 BYTE),
  LOAN_CODE                   VARCHAR2(50 BYTE),
  LOAN_TYPE                   VARCHAR2(50 BYTE),
  LOAN_DISBURSEMENT_DATE      VARCHAR2(50 BYTE),
  END_DATE_CONTRACT           VARCHAR2(50 BYTE),
  LAST_INSTALLMENT_PAID_DATE  VARCHAR2(50 BYTE),
  DISBURSED_AMOUNT            NUMBER(18,2),
  TOTAL_OUTSTANDING_AMT       NUMBER(18,2),
  PERIODICITY_PAYMENT         VARCHAR2(10 BYTE),
  TOTAL_NUM_INSTALLMENT       NUMBER,
  INSTALLMENT_AMT             NUMBER(18,2),
  NUM_REMAINING_INSTALLMENT   NUMBER,
  NUM_OVERDUE_INSTALLMENT     NUMBER,
  OVERDUE_AMT                 NUMBER(18,2),
  LOAN_STATUS                 VARCHAR2(20 BYTE),
  RESCHEDULE_NO               NUMBER,
  LAST_RESCHEDULE_DATE        VARCHAR2(50 BYTE),
  WRITE_OFF_AMT               NUMBER(18,2),
  WRITE_OFF_DATE              VARCHAR2(50 BYTE),
  CONTRACT_PHASE              VARCHAR2(10 BYTE),
  LOAN_DURATION               NUMBER,
  ACTUAL_END_DATE_CONTRACT    VARCHAR2(50 BYTE),
  ECONOMIC_PURPOSE_CODE       VARCHAR2(10 BYTE),
  COMPULSORY_SAVING_AMT       NUMBER(18,2),
  VOLUNTARY_SAVING_AMT        NUMBER(18,2),
  TERM_SAVING_AMT             NUMBER(18,2),
  SUBSIDIZED_CREDIT_FLAG      VARCHAR2(1 BYTE),
  SERVICE_CHARGE_RATE         NUMBER(5,2),
  PAYMENT_MODE                VARCHAR2(10 BYTE),
  ADVANCE_PAYMENT_AMT         NUMBER(18,2),
  LAW_SUIT                    VARCHAR2(1 BYTE),
  ME                          VARCHAR2(1 BYTE),
  MEMBER_WELFARE_FUND         VARCHAR2(1 BYTE),
  INSURANCE_COVERAGE          VARCHAR2(1 BYTE),
  ENTRY_USER                  VARCHAR2(50 BYTE),
  ENTRY_DATE                  VARCHAR2(50 BYTE) DEFAULT SYSDATE
)
TABLESPACE USERS
PCTUSED    0
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE
MONITORING;


CREATE OR REPLACE TRIGGER MRACIB."CIB_CONTRACT_DATA_UPLOAD_TRGGER" 
BEFORE INSERT ON MRACIB.CIB_CONTRACT_DATA
FOR EACH ROW
DECLARE
BEGIN
  IF :NEW.ENTRY_USER IS NULL THEN
    :NEW.ENTRY_USER := USER;
  END IF;
  IF :NEW.ENTRY_DATE IS NULL THEN
    :NEW.ENTRY_DATE := SYSDATE;
  END IF;
END;
/
